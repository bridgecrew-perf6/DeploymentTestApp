trigger:
  batch: true
  branches:
    include:
    - main

pool:
  name: DemoPool
  vmImage: 'windows-2022'

variables:
  runEndToEnd: $[ne(variables['Build.Reason'], 'PullRequest')]

# ---------------------------------

stages:
- stage: BuildStage
  displayName:  🏗 Build Stage
  dependsOn: []

  jobs:
  # this will create an error
  - job: HelloWorld
    displayName: Hello World
    steps:
    - script: |
        echo "Build reason: ${{variables['Build.Reason']}}"
        echo "Run e2e tests? ${{variables['runEndToEnd']}}"
        
# ---------------------------------

- stage: ResultStage
  displayName: 🚀 Build Result
  dependsOn: [ 'BuildStage' ]
  condition: always()
  
  jobs:
  - job: ResultJob
    displayName: 🚀 Build Results
    steps:
    - checkout: none
    - script: |
        echo "test"
      displayName: Fail build if partially successful
      